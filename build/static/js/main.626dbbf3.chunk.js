(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(31),s=n.n(r),i=n(21),o=n(2),l=n.n(o),u=n(5),b=n(4),j=n(12),d=n(3),p=n(0),m=function(e){var t=e.blog,n=e.updateLike,c=e.user,r=e.deleteBlog,s=Object(a.useState)(!0),i=Object(b.a)(s,2),o=i[0],l=i[1],u=Object(a.useState)(!1),j=Object(b.a)(u,2),d=j[0],m=j[1],f=function(){l(!o),o&&h()},h=function(){var e=t.likedBy.map((function(e){return e.username}));m(e.includes(c))};return Object(a.useEffect)((function(){l(!0)}),[]),Object(p.jsxs)("div",{className:"blog",children:[Object(p.jsxs)("div",{className:"blog__description",children:[Object(p.jsxs)("span",{className:"blog__description--title",children:[t.title," "]}),Object(p.jsxs)("span",{className:"blog__description--author",children:["- ",t.author]})]}),o?Object(p.jsxs)("div",{className:"blog__button",children:[Object(p.jsx)("button",{className:"btn-inline",onClick:f,children:"view"}),Object(p.jsx)("p",{className:"blog__button--likes",children:"roots: ".concat(t.likes)})]}):Object(p.jsxs)("div",{className:"blog__details",children:[Object(p.jsxs)("div",{className:"blog__button",children:[Object(p.jsx)("button",{className:"btn-inline",onClick:f,children:"hide"}),Object(p.jsx)("p",{className:"blog__button--likes",children:"roots: ".concat(t.likes)})]}),Object(p.jsxs)("div",{className:"blog__info",children:[Object(p.jsx)("a",{className:"blog__link",href:"http"!==t.url.slice(0,4)?"//"+t.url:t.url,children:t.url}),Object(p.jsx)("div",{className:"blog__like-container",children:Object(p.jsx)("button",{className:"blog__like-container--like-button",onClick:function(e){e.preventDefault(),n(t),m(!d)},children:d?Object(p.jsx)("img",{src:"img/thumb-green.png",alt:"green thumbs up",className:"blog__icon--unlike"}):Object(p.jsx)("img",{src:"img/thumb-brand.png",alt:"orange thumbs up",className:"blog__icon--like"})})})]}),Object(p.jsxs)("div",{className:"blog__posted",children:[Object(p.jsxs)("h2",{children:["Posted By: ",Object(p.jsx)("span",{children:t.user.name})]}),c===t.user.username?Object(p.jsx)("button",{className:"btn-inline blog__posted--remove",onClick:function(e){e.preventDefault();var n="Are you sure you want to remove ".concat(t.title," by ").concat(t.author,"?");window.confirm(n)&&r(t)},children:"remove"}):null]})]})]})},f=function(e){var t=e.iconName,n=e.component,a=e.componentTrail,c=void 0===a?"":a;return Object(p.jsx)("svg",{className:"".concat(n,"__icon").concat(c),fill:"black",width:"16px",height:"16px",viewBox:"0 0 20 20",children:Object(p.jsx)("use",{xlinkHref:"/sprite.svg#icon-".concat(t)})})},h=function(e){var t=e.login,n=Object(a.useState)(""),c=Object(b.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(""),o=Object(b.a)(i,2),d=o[0],m=o[1],h=function(){var e=Object(u.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({username:r,password:d}),s(""),m("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{className:"login",onSubmit:h,id:"loginForm",children:[Object(p.jsx)(f,{component:"login",iconName:"lock-closed-outline"}),Object(p.jsxs)("div",{className:"login__input",children:[Object(p.jsx)("label",{className:"login__label",children:"Username"}),Object(p.jsx)("input",{id:"username",type:"text",value:r,name:"Username",onChange:function(e){s(e.target.value)},label:"Username:"})]}),Object(p.jsxs)("div",{className:"login__input",children:[Object(p.jsx)("label",{className:"login__label",children:"Password"}),Object(p.jsx)("input",{id:"password",type:"password",value:d,name:"Password",onChange:function(e){m(e.target.value)}})]}),Object(p.jsx)("button",{className:"btn-inline",type:"submit",children:"login"}),Object(p.jsx)(j.b,{className:"btn-inline",to:"/users",children:"Create an account here"})]})},g=function(e){var t=e.createBlog,n=Object(a.useState)(""),c=Object(b.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(""),o=Object(b.a)(i,2),l=o[0],u=o[1],j=Object(a.useState)(""),d=Object(b.a)(j,2),m=d[0],f=d[1];return Object(p.jsxs)("form",{className:"blog-form",onSubmit:function(e){e.preventDefault(),t({author:r,title:l,url:m}),u(""),f(""),s("")},children:[Object(p.jsx)("h2",{children:"Create New"}),Object(p.jsxs)("div",{className:"blog-form__input",children:[Object(p.jsx)("label",{children:"Title"}),Object(p.jsx)("input",{id:"title",type:"text",name:"Title",value:l,onChange:function(e){u(e.target.value)}})]}),Object(p.jsxs)("div",{className:"blog-form__input",children:[Object(p.jsx)("label",{children:"Author"}),Object(p.jsx)("input",{id:"author",type:"text",value:r,name:"Author",onChange:function(e){s(e.target.value)}})]}),Object(p.jsxs)("div",{className:"blog-form__input",children:[Object(p.jsx)("label",{children:"Url"}),Object(p.jsx)("input",{id:"url",type:"text",value:m,name:"Url",onChange:function(e){f(e.target.value)}})]}),Object(p.jsx)("button",{className:"btn-inline blog-form__button",type:"submit",children:"save"})]})},O=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(b.a)(n,2),r=c[0],s=c[1],i={display:r?"none":""},o={display:r?"":"none"},l=function(){s(!r)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(p.jsxs)("div",{className:"toggle",children:[Object(p.jsx)("div",{style:i,children:Object(p.jsx)("button",{className:"btn-inline show__blogform__btn",onClick:l,children:e.buttonLabel})}),Object(p.jsxs)("div",{className:"toggle",style:o,children:[Object(p.jsx)("button",{className:"btn-inline show__blogform__btn",onClick:l,children:"cancel"}),e.children]})]})}));O.displayName="Togglable";var x=O,v=n(11),_=n.n(v),N="/api/blogs",w=null,k={getAll:function(){return _.a.get(N).then((function(e){return e.data}))},createBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},e.next=3,_.a.post(N,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),likeBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},a="".concat(N,"/").concat(t.id),e.next=4,_.a.put(a,t.likes,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:w}},a="".concat(N,"/").concat(t.id),e.next=4,_.a.delete(a,n);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){w="bearer ".concat(e)}},y={login:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S={createUser:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(e){var t=e.message;return null===t?null:Object(p.jsx)("div",{className:"notification",id:"notification",children:Object(p.jsx)("h2",{className:t.type,children:t.content})})},B=function(e){var t=e.message,n=e.user,a=e.handleLogout;return Object(p.jsxs)("div",{className:"header",children:[t?Object(p.jsx)("div",{className:"header__title",children:Object(p.jsx)(C,{message:t})}):Object(p.jsx)("div",{className:"header__title",children:Object(p.jsx)("img",{className:"header__title--logo",src:"img/logo-name.png",alt:"blog cabin logo"})}),n?Object(p.jsxs)("div",{className:"logout",children:[Object(p.jsxs)("p",{className:"logout__user",children:["Hello, ",n.name]}),Object(p.jsx)("button",{className:"btn-inline",onClick:a,children:"logout"})]}):null]})},T=function(e){var t=e.userCreate,n=Object(a.useState)(""),c=Object(b.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(""),o=Object(b.a)(i,2),d=o[0],m=o[1],h=Object(a.useState)(""),g=Object(b.a)(h,2),O=g[0],x=g[1],v=function(){var e=Object(u.a)(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({username:r,name:O,password:d}),s(""),m(""),x("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsxs)("form",{className:"login",onSubmit:v,id:"userForm",children:[Object(p.jsx)(f,{component:"login",iconName:"pencil"}),Object(p.jsxs)("div",{className:"login__input",children:[Object(p.jsx)("label",{className:"login__label",children:"Name"}),Object(p.jsx)("input",{id:"name",type:"text",value:O,name:"name",onChange:function(e){x(e.target.value)},label:"Name:"})]}),Object(p.jsxs)("div",{className:"login__input",children:[Object(p.jsx)("label",{className:"login__label",children:"Username"}),Object(p.jsx)("input",{id:"username",type:"text",value:r,name:"Username",onChange:function(e){s(e.target.value)},label:"Username:"})]}),Object(p.jsxs)("div",{className:"login__input",children:[Object(p.jsx)("label",{className:"login__label",children:"Password"}),Object(p.jsx)("input",{id:"password",type:"password",value:d,name:"Password",onChange:function(e){m(e.target.value)}})]}),Object(p.jsxs)("button",{className:"btn-inline",type:"submit",children:[Object(p.jsx)(j.b,{to:"/"}),"Create User"]}),Object(p.jsx)(j.b,{className:"btn-inline",to:"/",children:"Back"})]})},U=function(){var e=Object(a.useState)([]),t=Object(b.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(),s=Object(b.a)(r,2),o=s[0],f=s[1],O=Object(a.useState)(null),v=Object(b.a)(O,2),_=v[0],N=v[1],w=Object(a.useRef)(),C=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.getAll();case 2:t=e.sent,c(t.sort((function(e,t){return t.likes-e.likes})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)(C,[]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedInBlogappUser");if(e){var t=JSON.parse(e);N(t),k.setToken(t.token)}}),[]);var U=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.login(t);case 3:n=e.sent,window.localStorage.setItem("loggedInBlogappUser",JSON.stringify(n)),k.setToken(n.token),N(n),f({type:"notification__message",content:"".concat(n.username," login successful")}),setTimeout((function(){f(null)}),5e3),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),f({type:"notification__error",content:"wrong credentials"}),setTimeout((function(){f(null)}),5e3);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),I=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.createUser(t);case 3:n=e.sent,f({type:"notification__message",content:"".concat(n.username," creation successful")}),setTimeout((function(){f(null)}),5e3),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),f({type:"notification__error",content:e.t0.response.data.error}),setTimeout((function(){f(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.createBlog(t);case 3:a=e.sent,w.current.toggleVisibility(),c(n.concat(a)),f({type:"notification__message",content:"a new blog ".concat(a.title).concat(""===a.author?"":" by ".concat(a.author))}),setTimeout((function(){f(null)}),5e3),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),f({type:"notification__error",content:"Title and Url fields are required"}),setTimeout((function(){f(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.likeBlog(t);case 3:a=e.sent,r=Object(i.a)(n),s=r.findIndex((function(e){return e.id===a.id})),r[s]=a,c(r),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),f({type:"notification__error",content:"like error"}),setTimeout((function(){f(null)}),5e3);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.deleteBlog(t);case 3:a=(a=Object(i.a)(n)).filter((function(e){return e.id!==t.id})),c(a),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),f({type:"notification__error",content:"unauthorized"}),setTimeout((function(){f(null)}),5e3);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),P=function(e){e.preventDefault(),window.localStorage.removeItem("loggedInBlogappUser"),N(null)};return Object(p.jsx)(j.a,{children:Object(p.jsxs)(d.c,{children:[Object(p.jsx)(d.a,{path:"/users",children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)(B,{message:o,user:_,handleLogout:P}),Object(p.jsx)("div",{className:"content",children:Object(p.jsx)(T,{userCreate:I})})]})}),Object(p.jsx)(d.a,{path:"/",children:Object(p.jsxs)("div",{className:"container",children:[Object(p.jsx)(B,{message:o,user:_,handleLogout:P}),Object(p.jsxs)("div",{className:"content",children:[null===_?Object(p.jsx)(h,{login:U}):Object(p.jsx)("div",{className:"show__blogform",children:Object(p.jsx)(x,{class:"blog_form--toggle",buttonLabel:"Create New Blog",ref:w,children:Object(p.jsx)(g,{createBlog:A})})}),null!==_?Object(p.jsxs)("div",{className:"blog-container",children:[n.map((function(e){return Object(p.jsx)(m,{blog:e,updateLike:L,user:_.username,deleteBlog:D},e.id)}))," "]}):null]})]})})]})})};n(62);s.a.render(Object(p.jsx)(U,{}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.626dbbf3.chunk.js.map